import{_ as s,o as n,c as a,a as l}from"./app.65e841e0.js";const B=JSON.parse('{"title":"\u5C01\u88C5\u7F51\u7EDC\u8BF7\u6C42","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u914D\u7F6E\u6B65\u9AA4","slug":"\u914D\u7F6E\u6B65\u9AA4","link":"#\u914D\u7F6E\u6B65\u9AA4","children":[]},{"level":2,"title":"\u914D\u7F6E\u8BF4\u660E","slug":"\u914D\u7F6E\u8BF4\u660E","link":"#\u914D\u7F6E\u8BF4\u660E","children":[{"level":3,"title":"axios \u57FA\u672C\u4F7F\u7528","slug":"axios-\u57FA\u672C\u4F7F\u7528","link":"#axios-\u57FA\u672C\u4F7F\u7528","children":[]},{"level":3,"title":"axios \u4E8C\u6B21\u5C01\u88C5","slug":"axios-\u4E8C\u6B21\u5C01\u88C5","link":"#axios-\u4E8C\u6B21\u5C01\u88C5","children":[]},{"level":3,"title":"\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88","slug":"\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88","link":"#\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88","children":[]},{"level":3,"title":"\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42","slug":"\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42","link":"#\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42","children":[]}]}],"relativePath":"engineer/axios.md","lastUpdated":1672474416000}'),p={name:"engineer/axios.md"},o=l(`<h1 id="\u5C01\u88C5\u7F51\u7EDC\u8BF7\u6C42" tabindex="-1">\u5C01\u88C5\u7F51\u7EDC\u8BF7\u6C42 <a class="header-anchor" href="#\u5C01\u88C5\u7F51\u7EDC\u8BF7\u6C42" aria-hidden="true">#</a></h1><h2 id="\u914D\u7F6E\u6B65\u9AA4" tabindex="-1">\u914D\u7F6E\u6B65\u9AA4 <a class="header-anchor" href="#\u914D\u7F6E\u6B65\u9AA4" aria-hidden="true">#</a></h2><p>1\u3001\u5B89\u88C5\u4F9D\u8D56</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#c9d1d9;">npm i axios</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre></div><p>2\u3001\u65B0\u589E utils/request.ts \u6587\u4EF6</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> axios, { </span><span style="color:#FF7B72;">type</span><span style="color:#C9D1D9;"> AxiosRequestConfig, </span><span style="color:#FF7B72;">type</span><span style="color:#C9D1D9;"> AxiosInstance } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;axios&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { baseURL } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/configs/domain&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { TokenName } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/configs/const&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { localMng } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/utils/storage-mng&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Request</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">baseConfig</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    baseURL,</span></span>
<span class="line"><span style="color:#C9D1D9;">    headers: {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    timeout: </span><span style="color:#79C0FF;">20000</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">instance</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosInstance</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> axios.</span><span style="color:#D2A8FF;">create</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.baseConfig);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">constructor</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">token</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> localMng.</span><span style="color:#D2A8FF;">getItem</span><span style="color:#C9D1D9;">(TokenName);</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (token) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">setHeader</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">        Authorization: token,</span></span>
<span class="line"><span style="color:#C9D1D9;">      });</span></span>
<span class="line"><span style="color:#C9D1D9;">    } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">initInstance</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">initInstance</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.instance </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> axios.</span><span style="color:#D2A8FF;">create</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.baseConfig);</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">setReqInterceptors</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">setResInterceptors</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8BF7\u6C42\u62E6\u622A\u5668</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setReqInterceptors</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.instance.interceptors.request.</span><span style="color:#D2A8FF;">use</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">config</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// const { checkApiPermission } = usePermission()</span></span>
<span class="line"><span style="color:#C9D1D9;">        config.cancelToken </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> axios.</span><span style="color:#D2A8FF;">CancelToken</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">executor</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">c</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// if (!checkApiPermission(config.url)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">//   c(config.url + &#39;\u6CA1\u6709\u6743\u9650&#39;)</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">//   router.push(&#39;/error/forbidden&#39;)</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// }</span></span>
<span class="line"><span style="color:#C9D1D9;">        });</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> config;</span></span>
<span class="line"><span style="color:#C9D1D9;">      },</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">err</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;\u8BF7\u6C42\u5931\u8D25&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(err);</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    );</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u54CD\u5E94\u62E6\u622A\u5668</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setResInterceptors</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.instance.interceptors.response.</span><span style="color:#D2A8FF;">use</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">res</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">code</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">200</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">body</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">message</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> res.data;</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">switch</span><span style="color:#C9D1D9;"> (code) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">200</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">resolve</span><span style="color:#C9D1D9;">(body </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> res.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">401</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">            window.$message.</span><span style="color:#D2A8FF;">warning</span><span style="color:#C9D1D9;">(message </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;\u65E0\u6743\u9650&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(res.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">default</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">            window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(message </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;\u54CD\u5E94\u5931\u8D25&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(res.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      },</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">err</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (axios.</span><span style="color:#D2A8FF;">isCancel</span><span style="color:#C9D1D9;">(err)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;\u54CD\u5E94\u53D6\u6D88&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">        } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">          window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;\u54CD\u5E94\u5931\u8D25&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(err);</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    );</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8BBE\u7F6E\u8BF7\u6C42\u5934</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setHeader</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">headers</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.baseConfig.headers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> { </span><span style="color:#FF7B72;">...</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.baseConfig.headers, </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">headers };</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">initInstance</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// get\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">url</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">config</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Promise</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({ url, method: </span><span style="color:#A5D6FF;">&quot;get&quot;</span><span style="color:#C9D1D9;">, params: data, </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">config });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// post\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">post</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">url</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">config</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Promise</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({ url, method: </span><span style="color:#A5D6FF;">&quot;post&quot;</span><span style="color:#C9D1D9;">, data, </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">config });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u4E0D\u7ECF\u8FC7\u7EDF\u4E00\u7684axios\u5B9E\u4F8B\u7684post\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">getOnly</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">url</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">config</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Promise</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">axios</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">...</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.baseConfig,</span></span>
<span class="line"><span style="color:#C9D1D9;">      url,</span></span>
<span class="line"><span style="color:#C9D1D9;">      method: </span><span style="color:#A5D6FF;">&quot;get&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      params: data,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">config,</span></span>
<span class="line"><span style="color:#C9D1D9;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u4E0D\u7ECF\u8FC7\u7EDF\u4E00\u7684axios\u5B9E\u4F8B\u7684get\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">postOnly</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">url</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">config</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Promise</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">axios</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">...</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.baseConfig,</span></span>
<span class="line"><span style="color:#C9D1D9;">      url,</span></span>
<span class="line"><span style="color:#C9D1D9;">      method: </span><span style="color:#A5D6FF;">&quot;post&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      data,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">config,</span></span>
<span class="line"><span style="color:#C9D1D9;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// delete\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">deleteBody</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">url</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">config</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Promise</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({ url, method: </span><span style="color:#A5D6FF;">&quot;delete&quot;</span><span style="color:#C9D1D9;">, data, </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">config });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">public</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">deleteParam</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">url</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {},</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FFA657;">config</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">AxiosRequestConfig</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}</span></span>
<span class="line"><span style="color:#C9D1D9;">  )</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Promise</span><span style="color:#C9D1D9;">&lt;</span><span style="color:#79C0FF;">any</span><span style="color:#C9D1D9;">&gt; </span><span style="color:#FF7B72;">=&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({ url, method: </span><span style="color:#A5D6FF;">&quot;delete&quot;</span><span style="color:#C9D1D9;">, params: data, </span><span style="color:#FF7B72;">...</span><span style="color:#C9D1D9;">config });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">new</span><span style="color:#FFA657;"> </span><span style="color:#D2A8FF;">Request</span><span style="color:#FFA657;">()</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span></code></pre></div><p>3\u3001\u4F7F\u7528\u65B9\u5F0F</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> request </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/utils/request&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u767B\u5F55</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">apiGetUserInfo</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> request.</span><span style="color:#D2A8FF;">post</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;/sys/user/info&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">apiGetMenuList</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> request.</span><span style="color:#D2A8FF;">post</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;/sys/menus&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="\u914D\u7F6E\u8BF4\u660E" tabindex="-1">\u914D\u7F6E\u8BF4\u660E <a class="header-anchor" href="#\u914D\u7F6E\u8BF4\u660E" aria-hidden="true">#</a></h2><p>\u7F51\u7EDC\u5C01\u88C5\u4E3B\u8981\u662F\u5C01\u88C5 axios \u8BF7\u6C42\uFF0C\u5C01\u88C5\u901A\u7528\u7684 get\uFF0Cpost \u65B9\u6CD5\uFF0C\u8FD8\u6709\u6DFB\u52A0\u8BF7\u6C42\u62E6\u622A\u5668\u548C\u54CD\u5E94\u62E6\u622A\u5668\u3002</p><ul><li>\u8BF7\u6C42\u62E6\u622A\u5668\uFF1A\u4E3B\u8981\u6DFB\u52A0\u4E00\u4E9B\u6743\u9650\u7684\u6821\u9A8C\uFF0C\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88\u7B49</li><li>\u54CD\u5E94\u62E6\u622A\u5668\uFF1A\u4E3B\u8981\u5BF9\u8FD4\u56DE\u503C\u505A\u5904\u7406\uFF0C\u505A\u7EDF\u4E00\u7684 code \u5224\u65AD\uFF0C\u7EDF\u4E00\u7684\u5931\u8D25\u540E\u7684 tip \u63D0\u793A\u7B49\u3002</li></ul><h3 id="axios-\u57FA\u672C\u4F7F\u7528" tabindex="-1">axios \u57FA\u672C\u4F7F\u7528 <a class="header-anchor" href="#axios-\u57FA\u672C\u4F7F\u7528" aria-hidden="true">#</a></h3><p>\u5B89\u88C5\u597D\u4F9D\u8D56\u540E\uFF0C\u5728\u4F7F\u7528\u7684\u5730\u65B9\u76F4\u63A5\u5F15\u5165\u5C31\u53EF\u4EE5\u4E86\uFF1A</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki"><code><span class="line"><span style="color:#C9D1D9;">&lt;</span><span style="color:#7EE787;">script</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">setup</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> axios </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&#39;axios&#39;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">//...</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">axios</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">      url: </span><span style="color:#A5D6FF;">&#39;xxx&#39;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">...</span></span>
<span class="line"><span style="color:#C9D1D9;">  })</span></span>
<span class="line"><span style="color:#C9D1D9;">&lt;/</span><span style="color:#7EE787;">script</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="axios-\u4E8C\u6B21\u5C01\u88C5" tabindex="-1">axios \u4E8C\u6B21\u5C01\u88C5 <a class="header-anchor" href="#axios-\u4E8C\u6B21\u5C01\u88C5" aria-hidden="true">#</a></h3><p>\u5F88\u591A\u5173\u4E8E axios \u5C01\u88C5\u7684\u4EE3\u7801\u90FD\u4F1A\u5728 main.ts \u6587\u4EF6\u4E2D\u8FDB\u884C\u5168\u5C40\u5C5E\u6027\u7684\u914D\u7F6E\uFF0C\u6BD4\u5982\u8BBE\u7F6E axios \u7684\u8D85\u65F6\u65F6\u95F4\uFF1A</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#C9D1D9;">axios.defaults.timeout </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">20000</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span></code></pre></div><p>\u867D\u7136\u8FD9\u6837\u914D\u7F6E\u5E76\u6CA1\u6709\u4EC0\u4E48\u95EE\u9898\uFF0C\u4F46\u7F51\u7EDC\u8BF7\u6C42\u4E00\u822C\u5728\u6211\u4EEC\u7684\u5F00\u53D1\u4E2D\u4F1A\u4F5C\u4E3A\u4E00\u4E2A\u5355\u72EC\u6A21\u5757\u8FDB\u884C\u5C01\u88C5\uFF0C\u5BF9\u5916\u7EDF\u4E00\u63A5\u53E3\uFF0C\u8FD9\u6837\u7684\u597D\u5904\u662F\u6211\u4EEC\u53EF\u4EE5\u5728\u4E00\u4E2A\u96C6\u4E2D\u7684\u5730\u65B9\u8FDB\u884C\u7F51\u7EDC\u8BF7\u6C42\u7684\u76F8\u5173\u914D\u7F6E\uFF0C\u8FD8\u53EF\u4EE5\u5BF9\u8BF7\u6C42\u8FDB\u884C\u4E00\u4E9B\u9884\u5904\u7406\u548C\u8FD4\u56DE\u7ED3\u679C\u7684\u62E6\u622A\u5904\u7406\uFF0C\u4E5F\u4E0D\u4F1A\u4E0E main.ts \u6587\u4EF6\u4E2D\u672C\u8EAB\u7684\u903B\u8F91\u6DF7\u5408\u3002</p><p>\u6211\u4EEC\u65B0\u589E <code>request.ts</code> \u6587\u4EF6\uFF0C\u9700\u8981\u5B9E\u73B0\u4E0B\u9762\u529F\u80FD\uFF1A</p><ol><li>\u6DFB\u52A0\u8BF7\u6C42\u548C\u54CD\u5E94\u7684\u62E6\u622A</li><li>\u589E\u52A0\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88</li><li>\u5BF9\u5916\u7EDF\u4E00\u63A5\u53E3</li></ol><p>\u5177\u4F53\u4EE3\u7801\u5982\u4E0A\u9762\u7B2C\u4E8C\u6B65\u9AA4\u3002</p><p>\u4E0A\u9762\u6211\u4EEC\u4F7F\u5C01\u7740\u7684\u4E00\u4E2A<strong>\u7C7B</strong>\u7684\u5F62\u5F0F\uFF0C\u6216\u8005\u91C7\u7528\u53E6\u4E00\u79CD<strong>\u5BFC\u51FA\u5B9E\u4F8B</strong>\u7684\u65B9\u5F0F\u8FDB\u884C\u5C01\u88C5\uFF0C\u4E5F\u662F\u53EF\u4EE5\u7684\uFF1A</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> axios </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;axios&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u521B\u5EFA\u8BF7\u6C42\u5B9E\u4F8B</span></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">instance</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> axios.</span><span style="color:#D2A8FF;">create</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">  baseURL: </span><span style="color:#A5D6FF;">&quot;/api&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u6307\u5B9A\u8BF7\u6C42\u8D85\u65F6\u7684\u6BEB\u79D2\u6570</span></span>
<span class="line"><span style="color:#C9D1D9;">  timeout: </span><span style="color:#79C0FF;">20000</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8868\u793A\u8DE8\u57DF\u8BF7\u6C42\u65F6\u662F\u5426\u9700\u8981\u4F7F\u7528\u51ED\u8BC1</span></span>
<span class="line"><span style="color:#C9D1D9;">  withCredentials: </span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u524D\u7F6E\u62E6\u622A\u5668\uFF08\u53D1\u8D77\u8BF7\u6C42\u4E4B\u524D\u7684\u62E6\u622A\uFF09</span></span>
<span class="line"><span style="color:#C9D1D9;">instance.interceptors.request.</span><span style="color:#D2A8FF;">use</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">  (</span><span style="color:#FFA657;">config</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/**</span></span>
<span class="line"><span style="color:#8B949E;">     * \u5728\u8FD9\u91CC\u4E00\u822C\u4F1A\u643A\u5E26\u524D\u53F0\u7684\u53C2\u6570\u53D1\u9001\u7ED9\u540E\u53F0\uFF0C\u6BD4\u5982\u4E0B\u9762\u8FD9\u6BB5\u4EE3\u7801\uFF1A</span></span>
<span class="line"><span style="color:#8B949E;">     * const token = getToken()</span></span>
<span class="line"><span style="color:#8B949E;">     * if (token) {</span></span>
<span class="line"><span style="color:#8B949E;">     *  config.headers.token = token</span></span>
<span class="line"><span style="color:#8B949E;">     * }</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> config;</span></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">  (</span><span style="color:#FFA657;">error</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(error);</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u540E\u7F6E\u62E6\u622A\u5668\uFF08\u83B7\u53D6\u5230\u54CD\u5E94\u65F6\u7684\u62E6\u622A\uFF09</span></span>
<span class="line"><span style="color:#C9D1D9;">instance.interceptors.response.</span><span style="color:#D2A8FF;">use</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">  (</span><span style="color:#FFA657;">response</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">/**</span></span>
<span class="line"><span style="color:#8B949E;">     * \u6839\u636E\u4F60\u7684\u9879\u76EE\u5B9E\u9645\u60C5\u51B5\u6765\u5BF9 response \u548C error \u505A\u5904\u7406</span></span>
<span class="line"><span style="color:#8B949E;">     * \u8FD9\u91CC\u5BF9 response \u548C error \u4E0D\u505A\u4EFB\u4F55\u5904\u7406\uFF0C\u76F4\u63A5\u8FD4\u56DE</span></span>
<span class="line"><span style="color:#8B949E;">     */</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> response;</span></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">  (</span><span style="color:#FFA657;">error</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">response</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> error;</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (response </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> response.data) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(error);</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">message</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> error;</span></span>
<span class="line"><span style="color:#C9D1D9;">    console.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(message);</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(error);</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">// \u5BFC\u51FA\u5E38\u7528\u51FD\u6570</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">/**</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{string}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">url</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{object}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">data</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{object}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">params</span></span>
<span class="line"><span style="color:#8B949E;"> */</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">post</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">url</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">data</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}, </span><span style="color:#FFA657;">params</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">    method: </span><span style="color:#A5D6FF;">&quot;post&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    url,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data,</span></span>
<span class="line"><span style="color:#C9D1D9;">    params,</span></span>
<span class="line"><span style="color:#C9D1D9;">  });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">/**</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{string}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">url</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{object}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">params</span></span>
<span class="line"><span style="color:#8B949E;"> */</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">get</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">url</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">params</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">    method: </span><span style="color:#A5D6FF;">&quot;get&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    url,</span></span>
<span class="line"><span style="color:#C9D1D9;">    params,</span></span>
<span class="line"><span style="color:#C9D1D9;">  });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">/**</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{string}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">url</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{object}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">data</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{object}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">params</span></span>
<span class="line"><span style="color:#8B949E;"> */</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">put</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">url</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">data</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}, </span><span style="color:#FFA657;">params</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">    method: </span><span style="color:#A5D6FF;">&quot;put&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    url,</span></span>
<span class="line"><span style="color:#C9D1D9;">    params,</span></span>
<span class="line"><span style="color:#C9D1D9;">    data,</span></span>
<span class="line"><span style="color:#C9D1D9;">  });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8B949E;">/**</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{string}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">url</span></span>
<span class="line"><span style="color:#8B949E;"> * </span><span style="color:#FF7B72;">@param</span><span style="color:#8B949E;"> </span><span style="color:#FFA657;">{object}</span><span style="color:#8B949E;"> </span><span style="color:#C9D1D9;">params</span></span>
<span class="line"><span style="color:#8B949E;"> */</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">_delete</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">url</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">params</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {}) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">instance</span><span style="color:#C9D1D9;">({</span></span>
<span class="line"><span style="color:#C9D1D9;">    method: </span><span style="color:#A5D6FF;">&quot;delete&quot;</span><span style="color:#C9D1D9;">,</span></span>
<span class="line"><span style="color:#C9D1D9;">    url,</span></span>
<span class="line"><span style="color:#C9D1D9;">    params,</span></span>
<span class="line"><span style="color:#C9D1D9;">  });</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">instance;</span></span>
<span class="line"></span></code></pre></div><h3 id="\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88" tabindex="-1">\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88 <a class="header-anchor" href="#\u91CD\u590D\u8BF7\u6C42\u7684\u53D6\u6D88" aria-hidden="true">#</a></h3><p>\u6709\u65F6\u5019\uFF0C\u4E3A\u4E86\u907F\u514D\u63A5\u53E3\u7684\u91CD\u590D\u8C03\u7528\uFF0C\u6BD4\u5982\u8868\u5355\u7684\u63D0\u4EA4\uFF0C\u6211\u4EEC\u901A\u5E38\u5728\u63D0\u4EA4\u6309\u94AE\u4E0A\u52A0\u4E00\u4E2A loading\uFF0C\u5F53\u6709\u7ED3\u679C\u8FD4\u56DE\u65F6\u624D\u80FD\u518D\u6B21\u63D0\u4EA4\u3002\u4F46\u662F\u6709\u65F6\u5019\u603B\u4F1A\u5FD8\u8BB0\u52A0\u8FD9\u4E2A loading\uFF0C\u5BFC\u81F4\u8868\u5355\u91CD\u590D\u63D0\u4EA4\u3002</p><p>\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u5728\u5C01\u88C5 axios \u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u901A\u8FC7\u5185\u90E8\u63D0\u4F9B\u7684 <code>AbortController</code> \u6765\u53D6\u6D88\u91CD\u590D\u7684\u7F51\u7EDC\u8BF7\u6C42\u3002</p><p><strong>\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\u7684\u539F\u7406\u5982\u4E0B</strong>\uFF1A</p><p>\u6211\u4EEC\u5BF9\u6BCF\u4E2A\u8BF7\u6C42\u751F\u6210\u4E00\u4E2A\u72EC\u4E00\u65E0\u4E8C\u7684 key \u503C\uFF0C\u5728\u53D1\u9001\u8BF7\u6C42\u7684\u65F6\u5019\uFF0C\u5C06\u8FD9\u4E2A key \u503C\u4FDD\u5B58\u8D77\u6765\uFF0C\u5F53\u6709\u91CD\u590D\u7684\u8BF7\u6C42\u53D1\u9001\u65F6\uFF0C\u6211\u4EEC\u5224\u65AD\u5F53\u524D key \u503C\u7684\u8BF7\u6C42\u6B63\u5728\u8FDB\u884C\u4E2D\uFF0C\u5C31\u8C03\u7528 aixos \u63D0\u4F9B\u7684\u53D6\u6D88\u8BF7\u6C42\u7684\u65B9\u6CD5\u53D6\u6D88\u5F53\u524D\u8BF7\u6C42\uFF0C\u8BF7\u6C42\u8FD4\u56DE\u540E\uFF0C\u518D\u5C06 key \u503C\u4ECE\u4FDD\u5B58\u4E2D\u79FB\u9664\uFF0C\u8BA9\u4E0B\u4E00\u6B21\u8BF7\u6C42\u53EF\u4EE5\u6210\u529F\u53D1\u9001\u3002</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>\u4F46\u662F\u9700\u8981\u6CE8\u610F\uFF0C\u5E76\u4E0D\u662F\u6240\u6709\u7684\u9879\u76EE\u90FD\u9700\u8981\u53D6\u6D88\u91CD\u590D\u63A5\u53E3\u64CD\u4F5C\uFF0C\u56E0\u4E3A\u6BD4\u5982\u6709\u7684\u5904\u7406\u662F\u540E\u7AEF\u5904\u7406\uFF0C\u7136\u540E\u524D\u7AEF\u8F6E\u8BE2\u67E5\u8BE2\uFF0C\u8FD9\u4E2A\u65F6\u5019\u5C31\u662F\u4E0D\u5408\u9002\u7684\u3002</p><p>\u53C2\u8003\u94FE\u63A5\uFF1A<a href="https://ssshooter.com/2022-06-23-cancel-ajax/" target="_blank" rel="noreferrer">Ajax \u600E\u4E48\u53D6\u6D88\uFF1F\u8981\u4E0D\u8981\u53D6\u6D88\uFF1F</a></p></div><p>\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\u5177\u4F53\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> axios, { AxiosRequestConfig, AxiosInstance } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;axios&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { baseURL } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/config/domain&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { TokenName } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/config/const&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { useAppStoreWithOut } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/store&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { usePermission } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/hooks&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> router </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/router&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> { localMng } </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;@/utils/storage-mng&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#FF7B72;">import</span><span style="color:#C9D1D9;"> md5 </span><span style="color:#FF7B72;">from</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;md5&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">appStore</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useAppStoreWithOut</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Request</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u8BF7\u6C42\u62E6\u622A\u5668</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setReqInterceptors</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.instance.interceptors.request.</span><span style="color:#D2A8FF;">use</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">config</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">controller</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">AbortController</span><span style="color:#C9D1D9;">(); </span><span style="color:#8B949E;">// \u6BCF\u4E2A\u8BF7\u6C42\u65F6\u90FD\u65B0\u751F\u6210\u4E00\u4E2AAbortController\u5B9E\u4F8B</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">        config.signal </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> controller.signal;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#8B949E;">// \u8BA1\u7B97\u5F53\u524D\u8BF7\u6C42key\u503C</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">key</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">getRequestKey</span><span style="color:#C9D1D9;">(config);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">checkPending</span><span style="color:#C9D1D9;">(key)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#8B949E;">// \u91CD\u590D\u8BF7\u6C42\u5219\u53D6\u6D88\u5F53\u524D\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">          appStore.</span><span style="color:#D2A8FF;">requests</span><span style="color:#C9D1D9;">(key).</span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">        } </span><span style="color:#FF7B72;">else</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">          appStore.</span><span style="color:#D2A8FF;">addRequest</span><span style="color:#C9D1D9;">(key, controller);</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> config;</span></span>
<span class="line"><span style="color:#C9D1D9;">      },</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">err</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;\u8BF7\u6C42\u5931\u8D25&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(err);</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    );</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u54CD\u5E94\u62E6\u622A\u5668</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">setResInterceptors</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.instance.interceptors.response.</span><span style="color:#D2A8FF;">use</span><span style="color:#C9D1D9;">(</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">res</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> { </span><span style="color:#79C0FF;">code</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">200</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">body</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">message</span><span style="color:#C9D1D9;"> } </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> res.data;</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">switch</span><span style="color:#C9D1D9;"> (code) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">200</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#8B949E;">// \u8BF7\u6C42\u5B8C\u6210\uFF0C\u5220\u9664\u8BF7\u6C42\u4E2D\u72B6\u6001</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">key</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">getRequestKey</span><span style="color:#C9D1D9;">(res.config);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">removePending</span><span style="color:#C9D1D9;">(key);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">resolve</span><span style="color:#C9D1D9;">(body </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> res.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">case</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">401</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">            window.$message.</span><span style="color:#D2A8FF;">warning</span><span style="color:#C9D1D9;">(message </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;\u65E0\u6743\u9650&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">            appStore.</span><span style="color:#D2A8FF;">logout</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">false</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(res.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">          </span><span style="color:#FF7B72;">default</span><span style="color:#C9D1D9;">:</span></span>
<span class="line"><span style="color:#C9D1D9;">            window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(message </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;\u54CD\u5E94\u5931\u8D25&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">            </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(res.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">      },</span></span>
<span class="line"><span style="color:#C9D1D9;">      (</span><span style="color:#FFA657;">err</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">axios.</span><span style="color:#D2A8FF;">isCancel</span><span style="color:#C9D1D9;">(err)) {</span></span>
<span class="line"><span style="color:#C9D1D9;">          window.$message.</span><span style="color:#D2A8FF;">error</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;\u54CD\u5E94\u5931\u8D25&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">        }</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">Promise</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">reject</span><span style="color:#C9D1D9;">(err);</span></span>
<span class="line"><span style="color:#C9D1D9;">      }</span></span>
<span class="line"><span style="color:#C9D1D9;">    );</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u68C0\u67E5key\u503C</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">checkPending</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">!!</span><span style="color:#C9D1D9;">appStore.requests[key];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u5220\u9664key\u503C</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">removePending</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">delete</span><span style="color:#C9D1D9;"> appStore.requests[key];</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u53EF\u4EE5\u6839\u636E\u8BF7\u6C42\u7684\u5730\u5740\uFF0C\u65B9\u5F0F\uFF0C\u53C2\u6570\uFF0C\u7EDF\u4E00\u8BA1\u7B97\u51FA\u5F53\u524D\u8BF7\u6C42\u7684md5\u503C\u4F5C\u4E3Akey</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">private</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">getRequestKey</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">config</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">config) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#8B949E;">// \u5982\u679C\u6CA1\u6709\u83B7\u53D6\u5230\u8BF7\u6C42\u7684\u76F8\u5173\u914D\u7F6E\u4FE1\u606F\uFF0C\u6839\u636E\u65F6\u95F4\u6233\u751F\u6210</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">md5</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">+new</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Date</span><span style="color:#C9D1D9;">());</span></span>
<span class="line"><span style="color:#C9D1D9;">    }</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">data</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">typeof</span><span style="color:#C9D1D9;"> config.data </span><span style="color:#FF7B72;">===</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;string&quot;</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">?</span><span style="color:#C9D1D9;"> config.data</span></span>
<span class="line"><span style="color:#C9D1D9;">        </span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">JSON</span><span style="color:#C9D1D9;">.</span><span style="color:#D2A8FF;">stringify</span><span style="color:#C9D1D9;">(config.data);</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">md5</span><span style="color:#C9D1D9;">(config.url </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;&amp;&quot;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> config.method </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;&amp;&quot;</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> data);</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">//...</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">new</span><span style="color:#FFA657;"> </span><span style="color:#D2A8FF;">Request</span><span style="color:#FFA657;">()</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>AbortController \u517C\u5BB9\u6027\uFF1AChrome &gt; 66\uFF0C\u4E0D\u652F\u6301 IE11</p></div><h3 id="\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42" tabindex="-1">\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42 <a class="header-anchor" href="#\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42" aria-hidden="true">#</a></h3><p>\u6211\u4EEC\u8FD8\u53EF\u4EE5\u8FDB\u4E00\u6B65\u5C06\u53D6\u6D88\u8BF7\u6C42\u548C\u8DEF\u7531\u8DF3\u8F6C\u7ED3\u5408\uFF0C<strong>\u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42</strong>\u3002</p><p>\u601D\u8DEF\u5982\u4E0B\uFF1A</p><p>1\u3001\u7531\u4E8E\u5728\u4F7F\u7528 <code>controller.abort()</code> \u4E4B\u540E\uFF0C\u65E0\u6CD5\u518D\u6B21\u8BF7\u6C42\uFF0C\u6240\u4EE5\u5FC5\u987B\u91CD\u65B0 new AbortController() \u7136\u540E\u8BBE\u7F6E signal\uFF0C\u63A5\u53E3\u8BF7\u6C42\u624D\u80FD\u751F\u6548\uFF0C\u6240\u4EE5\u6BCF\u6B21\u8BF7\u6C42\u90FD\u9700\u8981\u91CD\u65B0 new AbortController()\u3002</p><p>2\u3001\u7136\u540E\uFF0C\u6211\u4EEC\u9700\u8981\u5728 <code>router.beforeEach</code> \u4E2D <code>abort</code>\uFF0C\u5C31\u9700\u8981\u628A\u6240\u6709 new AbortController()\u7684\u5B9E\u4F8B\u5B58\u50A8\u5728 store \u4E2D\uFF0C\u5E76\u4E14\u4F7F\u7528 key \u5F00\u505A\u7D22\u5F15\uFF0C\u5B58\u50A8\u7ED3\u6784\u5982\u4E0B\uFF1A</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">	</span><span style="color:#A5D6FF;">&quot;4273984623896423984&quot;</span><span style="color:#C9D1D9;">: AbortController\u5B9E\u4F8B1,</span></span>
<span class="line"><span style="color:#C9D1D9;">	</span><span style="color:#A5D6FF;">&quot;2364283462983462394&quot;</span><span style="color:#C9D1D9;">: AbortController\u5B9E\u4F8B2</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">...</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span></code></pre></div><p>key \u4E3A getRequestKey \u8FD4\u56DE\u503C\uFF0Cvalue \u4E3A\u5BF9\u5E94\u7684 new AbortController()\u5B9E\u4F8B\u3002</p><p>3\u3001\u5728\u8BF7\u6C42\u62E6\u622A\u5668\u4E2D\uFF0C\u5224\u65AD\u5982\u679C key \u5B58\u5728\uFF0C\u5C31\u4F7F\u7528\u5BF9\u5E94\u7684 value \u6267\u884C abort \u51FD\u6570\u3002</p><p>4\u3001\u5982\u679C\u5728 router.beforeEach\uFF0C\u5C31\u904D\u5386\u5BF9\u8C61\uFF0C\u6267\u884C\u6240\u6709\u5B9E\u4F8B\u7684 abort \u65B9\u6CD5\u3002</p><p>\u793A\u4F8B\u4EE3\u7801\u5982\u4E0B\uFF1A</p><p>store \u4E2D\u589E\u52A0\uFF1A</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">useAppStore</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">defineStore</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;app&quot;</span><span style="color:#C9D1D9;">, {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">state</span><span style="color:#C9D1D9;">: ()</span><span style="color:#FF7B72;">:</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">IState</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> ({</span></span>
<span class="line"><span style="color:#C9D1D9;">    requests: {}, </span><span style="color:#8B949E;">// \u5B58\u50A8\u6BCF\u4E2A\u8BF7\u6C42\u3002\u5F62\u5F0F\uFF1A{ md5: controller }</span></span>
<span class="line"><span style="color:#C9D1D9;">  }),</span></span>
<span class="line"><span style="color:#C9D1D9;">  actions: {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u589E\u52A0\u8BF7\u6C42controller</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">addRequest</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">key</span><span style="color:#C9D1D9;">, </span><span style="color:#FFA657;">controller</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.requests[key] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> controller;</span></span>
<span class="line"><span style="color:#C9D1D9;">      console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;this.requests==&gt;&quot;</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.requests);</span></span>
<span class="line"><span style="color:#C9D1D9;">    },</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#8B949E;">// \u53D6\u6D88\u6240\u6709\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">requestAbort</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#FF7B72;">let</span><span style="color:#C9D1D9;"> controllers </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> Object.</span><span style="color:#D2A8FF;">values</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.requests);</span></span>
<span class="line"><span style="color:#C9D1D9;">      controllers.</span><span style="color:#D2A8FF;">forEach</span><span style="color:#C9D1D9;">((</span><span style="color:#FFA657;">controller</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> controller.</span><span style="color:#D2A8FF;">abort</span><span style="color:#C9D1D9;">());</span></span>
<span class="line"><span style="color:#C9D1D9;">      </span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.requests </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> {};</span></span>
<span class="line"><span style="color:#C9D1D9;">      console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;request abort!&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">    },</span></span>
<span class="line"><span style="color:#C9D1D9;">  },</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useAppStoreWithOut</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useAppStore</span><span style="color:#C9D1D9;">(store);</span></span>
<span class="line"></span></code></pre></div><p>\u5728\u5168\u5C40\u5BFC\u822A\u5B88\u536B\u4E2D\uFF1A</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#8B949E;">// \u5BFC\u822A\u5B88\u536B</span></span>
<span class="line"><span style="color:#C9D1D9;">router.</span><span style="color:#D2A8FF;">beforeEach</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">async</span><span style="color:#C9D1D9;"> (</span><span style="color:#FFA657;">to</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;=======router.beforeEach=========&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">appStore</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useAppStoreWithOut</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">title</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> (to.meta </span><span style="color:#FF7B72;">&amp;&amp;</span><span style="color:#C9D1D9;"> (to.meta.title </span><span style="color:#FF7B72;">as</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">string</span><span style="color:#C9D1D9;">)) </span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;"> </span><span style="color:#A5D6FF;">&quot;&quot;</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;"> (title) {</span></span>
<span class="line"><span style="color:#C9D1D9;">    document.title </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> title;</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">appStore</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useAppStoreWithOut</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">// \u5728\u8DEF\u7531\u8DF3\u8F6C\u7684\u65F6\u5019\u53D6\u6D88\u6240\u6709\u8BF7\u6C42</span></span>
<span class="line"><span style="color:#C9D1D9;">  appStore.</span><span style="color:#D2A8FF;">requestAbort</span><span style="color:#C9D1D9;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">//...</span></span>
<span class="line"><span style="color:#C9D1D9;">});</span></span>
<span class="line"></span></code></pre></div>`,46),e=[o];function t(c,r,D,y,F,C){return n(),a("div",null,e)}const u=s(p,[["render",t]]);export{B as __pageData,u as default};
